\section{Imachination}
\label{sec:imachination}

[TODO: indsæt billede af start menu] 

Spillet viser produktet af et barns fantasi. Startmenuen viser en
dreng der leger i sin sandkasse. I sin leg skal han grave sig til Kina
og for at komme igennem jorden må han bygge en maskine og kæmpe sig
vej mod underlige væsener og andre maskiner.  [Screenshot af progress
gennem jorden] Der er taget udgangspunkt i børns betagelse af store
maskiner. Især drenge er meget fascineret af hvordan maskiner virker,
og det er som regel altid et hit med køretøjer eller maskiner blandt
drengebørn. Vi har i spillet prøvet at opnå en ``wauw'' effekt ved at
se på hvordan børn fantaserer og leger. ``Hvad er endnu bedre end en
kanon? En større kanon''.  Spillet er todelt. Første del er en
byggedel, hvor man skal konstruere sin maskine fra forskellige
våben. Anden del er en ``RTS''-del hvor spilleren skal manøvrere sin
maskine rundt igennem underjordiske grotter og bekæmpe modstandere.

[Screenshot af garage] Man bygger sin maskine ved at trække våben ned
i dens \emph{sockets}. Det er ligeledes muligt at fjerne eller flytte
våben. Man kan rotere sin maskine ved hjælp af pilene i siden af
skærmen, eller ved at trække i maskinen.

[Screenshot af RTS] Maskinen kører fremad når man holder venstre
museknap nede. Maskinen roterer hele tiden for at holde fronten mod
musen. Det er muligt at trykke på sig selv og derved affyre sit
\emph{repulsor}-våben, som skubber fjender væk. Målet er at
positionere sig selv så det er muligt at ødelægge de bygninger der
befinder sig rundt i banerne. Derefter skal man besejre bossen.  Begge
dele naturligvis uden at dø.  Alle banerne har form som
sandkassen. Hvis man kigger nøje efter, kan man se at mange af
ikonerne til våben, fjender og lignende kan findes i sandkassen.

For at underbygge følelsen af at det er et barn der forestiller sig
hele spillet valgte vi at få børn til at indtale alle lydeffekter i
spillet. Det er en håndfuld børn fra det lokale fritidshjem som udover
at teste spillet, har indtalt skydelyde, eksplosionslyde og meget
mere. Det er også et syvårigt barn der har indtalt \emph{voice-over}
stemmen til vores trailer\citep{imatrailer} på engelsk selvom han ikke
kunne tale engelsk. Manuskriptet er blevet læst højt for ham og han er
så blevet optaget mens han forsøgte at gentage ordene. Det bidrager
til følelsen af at han sad og legede for sig selv i sin sandkasse.

\subsection{Arbejdsmetoder}
\label{sec:arbejdsmetoder}

Vores projekt blev kørt med \emph{SCRUM}-møder hver morgen. Hver
enkelt fortalte hvad der var blevet lavet dagen før, og hvad der var
planlagt at man skulle bruge dagen på.  Derudover var der ikke meget
styring af udviklingen. Der var møder hvor vores \emph{leads} fra
hvert felt snakkede med instruktør, designer og \emph{project
  manager}, men udover det var der ikke meget koordinering med resten
af gruppen. Internt på programmørholdet havde vores \emph{lead} et
lille overblik over hvor langt vi var nået, men deudover arbejdede vi
bare derudaf.

Vores leadprogrammør forsøgte sig med at sætte post-its op på væggen,
med de forskellige opgaver der skulle løses, samt en estimeret tid af
ogpaven. Man skulle så tage en post-it når man gik igang med at løse
opgaven, og returnere den når man havde fuldført den, og notere på den
hvor lang tid det reelt tog at løse opgaven. Systemet gik dødt da det
ikke blev opdateret med nye opgaver gennem projektet. Vi endte med at
holde en fejlliste på et \emph{whiteboard} som blev opdateret løbende.

Vi arbejdede alle 13 i samme rum. Det gav en del støj og på grund af
afbrydelser var det til tider svært at koncentrere sig. Til gengæld
gav det mulighed for hele tiden at følge med i hvad andre lavede. Det
gjorde at de forskellige faggrupper aldrig gik skævt af hinanden.


\subsection{Forløb}

Før selve produktionen begyndte, var vi en håndfuld fra holdet der
satte os ned og snakkede om, hvilken type spil vi kunne lave, samt
hvilket tema det skulle have. Gruppen bestod af vores game director,
game designer, project manager, art director, visual artist og jeg som
programmør. Vi fik sorteret i nogle tidlige brainstormideer og
fastlagt en mere konkret idé. I det første udkast var det et spil om
byggepladser. Man var en byggemand der konkurrerede mod de
omkringliggende byggeprojekter. Man skulle samtidig med at man byggede
sit eget op sabotere de andres byggeprojekter. Det var først da vi fik
fantasien, om at grave sig ned til kineserne, ind i konceptet at spillet
ændrede sig til at man skulle bekæmpe underjordiske
væsener. Da spillet henvender sig til små børn skal man passe på
hvad der bliver slået og skudt efter. Det er mere acceptabelt at skyde
efter underlige væsener end mennesker.

Den første dag af produktionen blev idéen \emph{pitched} til hele
gruppen. Da ideen faldt i god jord sparede vi værdifuld tid i
præproduktionen, da vi allerede få timer efter at have mødtes kunne
begynde at udvikle prototyper.

Da vores spil består af to vidt forskellige dele, bygge delen og køre
delen, startede programmørerne med at lave prototyper inddelt i to
grupper. Sammen med en anden programmør blev jeg sat til at prototype
en kasse der kunne følge efter musen i et isometrisk perspektiv. De to
dele skulle senere sættes sammen i spillet.


\subsection{Mit fokus} 
\label{sec:mitfokus}

Til at begynde med var jeg den programmør der skulle bruge mest tid på
KI'en grundet min bacheloropgave. Det var idéen at jeg ville kunne
bruge de to midterste af de fire uger på at udvikle KI'en til
spillet. Det viste sig hurtigt, at det var et meget urealistisk bud, da
holdet var meget tidspresset af blot at få spillet færdigt uden
avanceret KI. Derfor blev det ikke til så meget KI som jeg havde
håbet, men en del mere implementering af diverse ting til spillet.

Som førnævnt blev vores prototypeudvikling opdelt i to grupper. Jeg
skulle lave vores bevægelses system, hvor maskinen skulle følge efter
musen hvis man holdt museknappen nede.


Maskinen roterer hele tiden mod det punkt i terrænet som musen peger
på. Hvis man trykker på museknappen begynder maskinen at køre
fremad. I den første prototype blev maskinen flyttet med
translateringer, hvilket ødelagde det fysiksystem Unity har
indbygget. Det blev ændret således at maskinen får tilføjet en kraft i
dens fremadretning. Det gjorde derimod at bliven beholder en kraft i
en retning selvom den drejer hvilket får maskinen til at skride
ud. Denne metode kunne vi ikke bruge da vi gerne ville have en mere
kampvognsagtig opførsel. Vi ændrede al kraft maskinen får fra
accelerering til at være i fremadretningen. Når maskinen drejer vil al
dens momentum blive ændret i drejeretningen.  Vi blev også nødt til at
begrænse kraften maskinen kunne få på af y aksen. Det kunne forekomme
at bossen og spilleren fik lavet sammenstød der skabte enorm
opdrift. Derfor at der blot sat en maks begrænsning på hvor meget
opdrift maskinen kan have på et givent tidspunkt. Dette forhindrer
maskinen i at flyve højt op med mindre der konstant bliver tilføjet
kraft til den.

Vi testede gentagne gange spillet på børn fra det lokale fritidshjem,
og børnene kunne finde ud af at manøvrere rundt i spillet. Adspurgt
havde de intet at klage over. Alligevel viste det sig, at når voksne
spillede spillet, følte de ikke at maskinen reagerede som de
forventede. Det skyldes nok dels at børn er hurtigere til at acceptere
at tingene er som de er, frem for at ville have ting til at opføre sig
som de er vandt til. Derudover skyldes det nok at børnene gerne ville
være gode til at hjælpe og gode til at spille spillet, så de gav ikke
udtryk for deres problemer. Vi indså derfor at vi måtte gøre så meget
som muligt for at hjælpe spilleren. Det skulle være klarere hvilken
vej maskinen ville køre på et givent tidspunkt, og det skulle være
nemmere og sjovere at køre.

Da vores styring minder meget om at have en snor bundet fast i
maskinens forende valgte vi at forsøge at genskabe denne følelse. Vi
valgte derfor at øge drejehastigheden når vinklen var mellem den
nuværende og ønskede retning på maskinen forøgedes. Hvis man vil dreje
maskinen 180 grader, opfører den sig som om du havde trukket i en snor
der sidder fast på forenden af en kasse. Det vil sige at drejeradiusen
bliver lille, selvom man har fart på.

Det viste sig også at være et problem for voksne at se hvilken del af
maskinen der var forenden. På trods af at maskinen altid forsøger at
rotere mod musen. Derfor implementerede vi to styringsplaner omkring
maskinen som indeholder GUI der skal fortælle spilleren hvordan
maskinen vender, det orange lag. Den grønne pil indikerer hvilken
retning maskinen forsøger at dreje imod.  [muligvis
Screenshot af GUI planer]

Jeg lavede en del prototyping af våbene til maskinen. Det var den
oprindelige plan at der skulle laves fem våben til at starte med, og
den overskydende tid i projektet skulle bruges på at lave flere,
sjovere og skørere våben. Det viste sig dog at der ikke var noget
overskydende tid, så de fem oprindelige våben blev til de endelige
våben. Flammekasteren og saven er lavet med usynlige kasser. Så længe
en fjende opholder sig inde i kassen tager den skade. Dynamitkasteren
og gravearmen fungerer ved at give højere skade og kraft jo tættere fjenderne
er på nedslagspunktet. Dynamitstangen får blot tilføjet en
kraft i en retning og exploderer når den rammer noget. Laseren rammer
alt i en lige linje. Laseren kan ikke gå gennem vægge og har en
begrænset rækkevidde.

% [TODO: vi skal komme meget længere næste gang, ikke længere idag]

Det blev besluttet af vores lead programmør at vi skulle implementere
en allerede udviklet A* pathfinding som vi fandt på
nettet. Implementeringen havde både A* pathfinding samt en modul til
at generere et grid med et nemt brugerinterface. Desværre var det ikke
helt så smertefrit at implementere dette som først antaget. Vi fik
nogle ydelsesproblemer og da vi i spillets tredje bane har 50 små
fjender som jagter dig på en gang. Derfor måtte dele af koden
omskrives for at bruge mindre ressourcer. Det var hovedsageligt selve
styringen/flytningen af enheder der tog mange kræfter. Derfor
udskiftede vi Unitys indbyggede funktionalitet til at flytte figurer
med en ren kraftbaseret udgave. Derfor mistede vi også Unitys
kollissionsdetektering, så fjenderne kunne gå gennem terrænet. Derfor
blev de altid flyttet, så de var ovenpå terrænet.

Jeg arbejdede en del sammen med holdets animator da han skulle animere
de små fjender. Da vi havde overvundet de første problemer med at få
tingene til at spille sammen med Unity, var det ganske nemt at skifte
mellem animationer og samtidig få det til at se glidende ud.

\subsection{Problemer og udfordringer}

Undervejs i projektet gennemgik vores styrringssystem flere
iterationer. Vi havde mange problemer med at få maskinen til at
opføre sig naturligt uden at introducere nye problemer. F.eks. ville
vi gerne have maskinen til at tippe hvis den holdt på en skrå flade,
men den måtte samtidig ikke kunne vende på hovedet. Derfor lavede vi
en maksimal hældning, maskinen kunne have.

Vi havde også en del problemer med den feedback spilleren skulle have:
Undervejs i udviklingen var det en meget tom fornemmelse at køre rundt
og skyde ting. Derfor blev der gjort noget ud af at tilføje effekter
til både våben og fjender. Laseren har fx fået tilføjet rekyl, der
rykker maskinen en smule når våbenet affyres. Fjenderne flyver ud af
billedet med ild i halen når de bliver slået ihjel og de bygninger
hvor de kommer fra skubber spillerens maskine væk når de skyder.

\subsection{KI i spillet}

Vores små fjender bruger en simpel A* pathfinding algoritme. Der
bliver genereret et gitter, der viser de gangbare område. Fjenderne
finder derefter den korteste vej til spilleren og roterer, så har
fronten mod næste punkt på vejen. Når en fjende kommer tæt nok på
spilleren, stopper den og begynder at angribe spillerens maskine.

Vores små fjender er dem der skaber liv i banerne. Deres formål er til
dels at jagte spilleren, så der kommer masser af bevægelse i spillet.
Desuden lever de for at blive pløjet ned, så spilleren får lov at se
sine våben udfolde sig. Hvis der havde været mere tid til projektet
havde disse fjender været en oplagt mulighed at udvide. Fx kunne de
have fået nye våben. De kunne også dø på forskellige måder, alt efter
hvilket våben de er blevet skudt med. Derved kunne spilleren få en
masse feedback.

Oprindeligt var der lagt op til to typer fjender. Vi ville have
implementeret nogle skydende versioner af de små fjender, sådan at de
ikke alle blot løber hen i døden. På grund af tidsmangel blev
disse fraskrevet.

Det er små fjender, som vil skabe grundlaget for afprøvningen af
KI'en i spillet. Det er dem, som skaber mulighederne for både
alternativt gameplay, samt guider spilleren hen mod hans mål:
bygningerne, der \emph{spawner} fjender.

Vores boss KI bruger samme pathfinding som de små fjender. Desuden
vurderer den om den kan ramme med nogle af dens skydevåben på
afstand. Hvis den ser at den kan ramme med et skydevåben, roterer den
således at skydevåbenet peget i spillerens retning. Jo længere tid der
bliver brugt på at skyde med et våben, jo lavere vægt får det. Derfor
bliver bossen mere tilbøjelig til at skifte strategi. Det medfører at
han kører hen til spilleren og forsøger at bruge
nærkampsvåben. Skydevåbenets vægt stiger kontinuerligt over tid, så
hvis man kører væk fra bossen, skifter han taktik til igen at skyde
efter en.

I det originale design var det meningen at vi ville have implementeret
``seek and flee''\citep[afsnit 3.3.3]{aigames}. Desuden skulle bossen
kunne vurdere sin våbenstyrke i forhold til spilleren i henholdsvis
nærkamp og på afstand. På grund af tidsmangel i projektet blev disse
ting dog skåret fra. Holdet vurderede at der var for lille udbytte i
disse features, da spillet henvender sig til 6-7 årige børn.

Bossen har flere formål. Den skal være udfordringen som spilleren skal
overkomme, for at gøre sig fortjent til at spille næste bane. Da de
små fjender dør ekstremt let er det en smule mere tilfredsstillende at
få lov til at slå en lidt større maskine ihjel. Derudover giver bossen
et nyt våben som belønning hvis det lykkes spilleren at vinde kampen.
Desuden skal bossen fungere som tips og tricks til at bruge
våbene. Desuden skal han være et eksempel på hvordan man kan bygge en
maskine.

\subsection{Konklusion på produktet}
\label{sec:konkl-pa-prod}

Der er en masse ting i udviklingsprocessen, der kunne være gjort
anderledes og bedre. Fx ville det have været godt med lidt mere
planlægning i udviklingen blandt programmørerne. Der er også flere
ting i spillet som kunne være blevet forbedret. Med nogle ting, så som
styringen, var vi hæmmet af de krav der var blevet udstedt fra DADIUs
side. Andre ting, såsom flere våben, bedre feedback og mere varieret
gameplay gennem de forskellige baner, kunne være opnået ved at have
lidt længere tid til at udvikle. I sidste ende synes jeg dog at det er
et meget fint produkt vi har fået skabt på meget kort tid. Det har
potentiale til at blive rigtig godt hvis der udvikles videre på
det. Vi fik også meget positiv respons på spillet til evaluering på
DADIU og alle tre dommere så potentiale i spillet. Det blev enda nævnt
at vi skulle ændre aldersgruppen 30 år op, så censorerne også kunne få
lov at spille spillet. Censorerne foreslog også, at spillet blev
omdannet til et multiplayer-spil, eventuelt i form af et
MMO\footnote{Massively Multiplayer Online}-spil.
	
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../report"
%%% End:
